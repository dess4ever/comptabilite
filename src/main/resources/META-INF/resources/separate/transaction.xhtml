<ui:composition xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:p="http://primefaces.org/ui" xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:pe="http://primefaces.org/ui/extensions">
    <h:form id="transaction">
        <div class="container-fluid mt-5">
            <p:accordionPanel id="savedTransactions">
                <p:tab title="Transactions enregistrées">
                    <p:dataTable value="#{transactionView.transactions}" var="transaction" widgetVar="savedTransactions"
                        selection="#{transactionView.selectedTransaction}" rowKey="#{transaction.id}"
                        emptyMessage="Aucune transaction enregistrées" selectionMode="single" paginator="true"
                        paginatorPosition="both" rows="10" filteredValue="#{transactionView.filteredTransactions}">
                        <p:ajax event="rowSelect" listener="#{transactionView.onRowSelect}"
                            update="globalTab:vendorInvoice:transaction:savedTransactions:newTransaction" />
                        <p:column headerText="Activité liée" sortBy="#{transaction.refActivite}"
                            filterBy="#{transaction.refActivite}" filterMatchMode="contains">
                            <h:outputText value="#{transaction.refActivite}" />
                        </p:column>
                        <p:column headerText="Numéro de document" sortBy="#{transaction.number}"
                            filterBy="#{transaction.number}" filterMatchMode="contains">
                            <h:outputText value="#{transaction.number}" />
                        </p:column>
                        <p:column filterBy="#{transaction.invoiceDateC}" sortBy="#{transaction.invoiceDateC}"
                            headerText="Date du document" filterMatchMode="between">
                            <f:facet name="filter">
                                <p:datePicker selectionMode="range" onchange="PF('savedTransactions').filter()"
                                    pattern="dd/MM/yyyy" />
                            </f:facet>
                            <h:outputText value="#{transaction.invoiceDate}">
                                <f:convertDateTime pattern="dd/MM/yyyy" timeZone="Europe/Paris" />
                            </h:outputText>
                        </p:column>
                        <p:column headerText="Type de transaction" sortBy="#{transaction.type}"
                            filterBy="#{transaction.type}" filterMatchMode="contains">
                            <h:outputText value="#{transaction.type}" />
                        </p:column>
                        <p:column headerText="Type de document" sortBy="#{transaction.typeDocument}"
                            filterBy="#{transaction.typeDocument}" filterMatchMode="contains">
                            <h:outputText value="#{transaction.typeDocument}" />
                        </p:column>
                        <p:column headerText="Nom du vendeur" sortBy="#{transaction.vendor.society.name}"
                            filterBy="#{transaction.vendor.society.name}" filterMatchMode="contains">
                            <h:outputText value="#{transaction.vendor.society.name}" />
                        </p:column>
                        <p:column headerText="Nom du client" sortBy="#{transaction.customer.name}"
                            filterBy="#{transaction.customer.name}" filterMatchMode="contains">
                            <h:outputText value="#{transaction.customer.name}" />
                        </p:column>
                    </p:dataTable>
                </p:tab>
                <p:tab title="Transaction en cour">
                    <p:menubar>
                        <p:submenu label="Transaction">
                            <p:submenu label="Fichier">
                                <p:menuitem value="Enregistrer Transaction" icon="pi pi-save"
                                    action="#{transactionView.saveTransaction}" update="growl:growl globalTab:vendorInvoice:transaction:savedTransactions" />
                                <p:menuitem value="Nouvelle transaction" icon="pi pi-plus"
                                    action="#{transactionView.newTransaction}"
                                    update="globalTab:vendorInvoice:transaction:savedTransactions:newTransaction" />
                            </p:submenu>
                            <p:submenu label="Saisie">
                                <p:menuitem value="Mise à jour des dictionnaires" icon="pi pi-refresh"
                                    action="#{transactionView.updateDictionaries}" />
                            </p:submenu>
                        </p:submenu>
                    </p:menubar>
                    <p:accordionPanel id="newTransaction">
                        <p:tab title="Information générales">
                            <div class="row">
                                <div class="card col-6">
                                    <div class="card-body">
                                        <span class="ui-float-label mt-3">
                                            <p:autoComplete class="invoiceCardInput"
                                                value="#{transactionView.currentTransaction.refActivite}"
                                                scrollHeight="300"
                                                completeMethod="#{transactionView.completeLinkedActyvity}" />
                                            <p:outputLabel for="@previous" value="Activité liée" />
                                        </span>
                                        <span class="ui-float-label mt-3">
                                            <p:autoComplete class="invoiceCardInput"
                                                value="#{transactionView.currentTransaction.type}" scrollHeight="300"
                                                completeMethod="#{transactionView.completeType}" />
                                            <p:outputLabel for="@previous" value="Type de transaction" />
                                        </span>
                                        <span class="ui-float-label mt-3">
                                            <p:autoComplete class="w-100"
                                                value="#{transactionView.currentTransaction.typeDocument}"
                                                scrollHeight="300"
                                                completeMethod="#{transactionView.completeTypeDocument}" />
                                            <p:outputLabel for="@previous" value="Type de document" />
                                        </span>
                                        <span class="ui-float-label mt-3">
                                            <p:inputText class="w-100"
                                                value="#{transactionView.currentTransaction.number}" />
                                            <p:outputLabel for="@previous" value="Numéro du document" />
                                        </span>
                                        <span class="ui-float-label mt-3">
                                            <p:datePicker id="dateVendorInvoice1" class="w-100"
                                                value="#{transactionView.currentTransaction.invoiceDate}"
                                                pattern="dd/MM/yyyy" />
                                            <p:outputLabel for="@previous" value="Date du document" />
                                        </span>
                                    </div>
                                </div>
                                <div class="card col-6">
                                    <div class="card-body">
                                        <span class="ui-float-label mt-3">
                                            <p:autoComplete class="invoiceCardInput"
                                                value="#{transactionView.currentTransaction.payementStatus}"
                                                scrollHeight="300"
                                                completeMethod="#{transactionView.completeStatusOfPayement}" />
                                            <p:outputLabel for="@previous" value="Statut de paiement" />
                                        </span>
                                        <span class="ui-float-label mt-3">
                                            <p:datePicker class="w-100"
                                                value="#{transactionView.currentTransaction.dueDate}"
                                                pattern="dd/MM/yyyy" />
                                            <p:outputLabel for="@previous" value="Date d'échéance" />
                                        </span>
                                        <span class="ui-float-label mt-3">
                                            <p:datePicker class="w-100"
                                                value="#{transactionView.currentTransaction.payementDate}"
                                                pattern="dd/MM/yyyy" />
                                            <p:outputLabel for="@previous" value="Date de paiement" />
                                        </span>

                                        <span class="ui-float-label mt-3">
                                            <p:inputText class="w-100"
                                                value="#{transactionView.currentTransaction.payementMethod}" />
                                            <p:outputLabel for="@previous" value="Méthode de payement" />
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </p:tab>
                        <p:tab title="Compte de payement">
                            <div class="row">
                                <div class="card col-6">
                                    <p:panel id="CreditedAccount">
                                        <div class="card-header">
                                            <h4 class="card-title text-center">Compte crédité</h4>
                                        </div>
                                        <div class="card-body">
                                            <span class="ui-float-label mt-3">
                                                <p:autoComplete class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.destinationPayement.name}"
                                                    completeMethod="#{transactionView.completeAccountName}" scrollHeight="300">

                                                    <p:ajax event="itemSelect"
                                                        listener="#{transactionView.onCreditedAccountSelect}"
                                                        update="CreditedAccount" />
                                                </p:autoComplete>
                                                <p:outputLabel for="@previous" value="Nom associé au RIB" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.destinationPayement.bank_Name}" />
                                                <p:outputLabel for="@previous" value="Nom de la banque" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.destinationPayement.bank_Code}" />
                                                <p:outputLabel for="@previous" value="Code banque" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.destinationPayement.branch_Code}" />
                                                <p:outputLabel for="@previous" value="Code guichet" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.destinationPayement.account_Number}" />
                                                <p:outputLabel for="@previous" value="Numéro de comte" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.destinationPayement.iban}" />
                                                <p:outputLabel for="@previous" value="Numéro IBAN" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.destinationPayement.bic}" />
                                                <p:outputLabel for="@previous" value="Numéro BIC" />
                                            </span>
                                        </div>
                                        <div class="card-footer">
                                            <p:commandButton class="btn btn-primary w-100"
                                                value="Ajouter le compte de la société" icon="pi pi-plus"
                                                action="#{transactionView.addSocietyRibToCreditedAccount}"
                                                update="globalTab:vendorInvoice:transaction:savedTransactions:newTransaction:CreditedAccount" />
                                        </div>
                                    </p:panel>
                                </div>
                                <div class="card col-6">
                                    <p:panel id="debitedAccount">
                                        <div class="card-header">
                                            <h4 class="card-title text-center">Compte débité</h4>
                                        </div>
                                        <div class="card-body">
                                            <span class="ui-float-label mt-3">
                                                <p:autoComplete class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.originPayement.name}" scrollHeight="300"
                                                    completeMethod="#{transactionView.completeAccountName}">
                                                    <p:ajax event="itemSelect"
                                                        listener="#{transactionView.onDebitedAccountSelect}"
                                                        update="debitedAccount" />
                                                </p:autoComplete>
                                                <p:outputLabel for="@previous" value="Nom associé au RIB" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.originPayement.bank_Name}" />
                                                <p:outputLabel for="@previous" value="Nom de la banque" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.originPayement.bank_Code}" />
                                                <p:outputLabel for="@previous" value="Code banque" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.originPayement.branch_Code}" />
                                                <p:outputLabel for="@previous" value="Code guichet" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.originPayement.account_Number}" />
                                                <p:outputLabel for="@previous" value="Numéro de comte" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.originPayement.iban}" />
                                                <p:outputLabel for="@previous" value="Numéro IBAN" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.originPayement.bic}" />
                                                <p:outputLabel for="@previous" value="Numéro BIC" />
                                            </span>
                                        </div>
                                        <div class="card-footer">
                                            <p:commandButton class="btn btn-primary w-100"
                                                value="Ajouter le compte de la société" icon="pi pi-plus"
                                                action="#{transactionView.addSocietyRibToDebitedAccount}"
                                                update="globalTab:vendorInvoice:transaction:savedTransactions:newTransaction:debitedAccount" />
                                        </div>
                                    </p:panel>
                                </div>
                            </div>
                        </p:tab>
                        <p:tab title="Vendeur et client">
                            <div class="row">
                                <div class="card col-6">
                                    <p:panel id="vendorForm">
                                        <div class="card-header">
                                            <h4 class="card-title text-center">Fournisseur</h4>
                                        </div>
                                        <div class="card-body">
                                            <span class="ui-float-label mt-3">
                                                <p:autoComplete class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.vendor.society.name}" scrollHeight="300"
                                                    completeMethod="#{transactionView.completeSocietyName}">
                                                    <p:ajax event="itemSelect"
                                                        listener="#{transactionView.onVendorSelect}"
                                                        update="vendorForm" />
                                                </p:autoComplete>
                                                <p:outputLabel for="@previous" value="Nom de la société" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.vendor.society.address.name}" />
                                                <p:outputLabel for="@previous" value="Adresse" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.vendor.society.siret}" />
                                                <p:outputLabel for="@previous" value="Siret" />
                                            </span>
                                            <p:commandButton class="btn btn-primary invoiceCardInput"
                                                value="Chercher informations depuis le SIRET"
                                                actionListener="#{transactionView.searchFromSiret}"
                                                update="vendorForm growl:growl" />
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.vendor.society.siren}" />
                                                <p:outputLabel for="@previous" value="Siren" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.vendor.society.rcs}" />
                                                <p:outputLabel for="@previous" value="RCS" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.vendor.society.tva_Number}" />
                                                <p:outputLabel for="@previous" value="Numéro de TVA" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.vendor.society.phone}" />
                                                <p:outputLabel for="@previous" value="Téléphone" />
                                            </span>
                                        </div>
                                        <div class="card-footer">
                                            <p:commandButton class="btn btn-primary w-100" value="Ajouter la société"
                                                icon="pi pi-plus" action="#{transactionView.addSocietyToVendor}"
                                                update="vendorForm" />
                                        </div>
                                    </p:panel>
                                </div>
                                <div class="col-6">
                                    <p:panel id="customerForm">
                                        <div class="card-header">
                                            <h4 class="card-title text-center">Client</h4>
                                        </div>
                                        <div class="card-body">
                                            <span class="ui-float-label mt-3">
                                                <p:autoComplete class="invoiceCardInput" scrollHeight="300"
                                                    value="#{transactionView.currentTransaction.customer.name}"
                                                    completeMethod="#{transactionView.completeSocietyName}">
                                                    <p:ajax event="itemSelect"
                                                        listener="#{transactionView.onCustomerSelect}"
                                                        update="customerForm" />
                                                </p:autoComplete>
                                                <p:outputLabel for="@previous" value="Nom de la société" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.customer.address.name}" />
                                                <p:outputLabel for="@previous" value="Adresse" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.customer.siret}" />
                                                <p:outputLabel for="@previous" value="Siret" />
                                            </span>
                                            <p:commandButton class="btn btn-primary invoiceCardInput"
                                                value="Chercher informations depuis le SIRET"
                                                actionListener="#{transactionView.searchFromSiretCustomer}"
                                                update="customerForm growl:growl" />
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.customer.siren}" />
                                                <p:outputLabel for="@previous" value="Siren" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.customer.rcs}" />
                                                <p:outputLabel for="@previous" value="RCS" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.customer.tva_Number}" />
                                                <p:outputLabel for="@previous" value="Numéro de TVA" />
                                            </span>
                                            <span class="ui-float-label mt-3">
                                                <p:inputText class="invoiceCardInput"
                                                    value="#{transactionView.currentTransaction.customer.phone}" />
                                                <p:outputLabel for="@previous" value="Téléphone" />
                                            </span>
                                        </div>
                                        <div class="card-footer">
                                            <p:commandButton class="btn btn-primary w-100" value="Ajouter la société"
                                                icon="pi pi-plus" action="#{transactionView.addSocietyToCustomer}"
                                                update="globalTab:vendorInvoice:transaction:savedTransactions:newTransaction:customerForm" />
                                        </div>
                                    </p:panel>
                                </div>
                            </div>
                        </p:tab>
                        <p:tab title="Produits et service">
                            <div class="card">
                                <div class="card-body">
                                    <p:dataTable id="transactionLineTable" var="line"
                                        value="#{transactionView.currentTransaction.invoiceLines}" editable="true"
                                        selection="#{transactionView.selectedLine}" selectionMode="single"
                                        rowKey="#{line.rowKey}">

                                        <p:ajax event="rowEdit" listener="#{transactionView.onRowEdit}"
                                            update="growl:growl globalTab:vendorInvoice:transaction:savedTransactions:newTransaction:invoiceTotal" />
                                        <p:ajax event="rowEditCancel" listener="#{transactionView.onRowCancel}"
                                            update="growl:growl" />

                                        <p:column headerText="Nom">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.item.fact_Name}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:autoComplete value="#{line.item.fact_Name}" scrollHeight="300"
                                                        completeMethod="#{transactionView.completeItemName}">
                                                        <f:attribute name="currentLine" value="#{line}" />
                                                        <p:ajax event="itemSelect"
                                                            listener="#{transactionView.onItemForInvoiceLineSelect}"
                                                            update="transactionLineTable">
                                                        </p:ajax>
                                                    </p:autoComplete>
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="Catégorie">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.item.category.name}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:autoComplete value="#{line.item.category.name}"
                                                        scrollHeight="300"
                                                        completeMethod="#{transactionView.completeCategoryItem}" />

                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="Type (produit/service)">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.item.type}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputText value="#{line.item.type}" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="Référence">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.reference}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputText value="#{line.reference}" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="Date">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.date}">
                                                        <f:convertDateTime pattern="dd/MM/yyyy" timeZone="Europe/Paris" />
                                                    </h:outputText>
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:datePicker value="#{line.date}" pattern="dd/MM/yyyy" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="Quantité">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.quantity}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputNumber value="#{line.quantity}" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>

                                        <p:column headerText="Prix unitaire hors taxe">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.HTunitPrice}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputNumber value="#{line.HTunitPrice}" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>
                                        <p:column headerText="Prix total hors taxe">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.HTtotalPrice}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputNumber value="#{line.HTtotalPrice}" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>
                                        <p:column headerText="Code TVA">
                                            <p:cellEditor>
                                                <f:facet name="output">
                                                    <h:outputText value="#{line.item.tva.code}" />
                                                </f:facet>
                                                <f:facet name="input">
                                                    <p:inputText value="#{line.item.tva.code}" />
                                                </f:facet>
                                            </p:cellEditor>
                                        </p:column>
                                        <p:column>
                                            <p:rowEditor />
                                        </p:column>
                                    </p:dataTable>
                                    <div class="row mt-3">
                                        <div class="col-sm">
                                            <p:commandButton class="invoiceCardInput" value="Ajouter une ligne"
                                                icon="pi pi-plus" actionListener="#{transactionView.addTransactionLine}"
                                                update="transactionLineTable" />
                                        </div>
                                        <div class="col-sm">
                                            <p:commandButton class="invoiceCardInput"
                                                onclick="PF('openAiInvoiceLine').show()"
                                                value="Compléter automatiquement" icon="pi pi-plus" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="card">
                                <p:panelGrid id="invoiceTotal">
                                    <p:row>
                                        <p:column colspan="3">
                                            <h3 class="text-center">Total</h3>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <h4 class="text-center">Total HT</h4>
                                        </p:column>
                                        <p:column>
                                            <h4 class="text-center">Total TVA</h4>
                                        </p:column>
                                        <p:column>
                                            <h4 class="text-center">Total TTC</h4>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column>
                                            <h:outputText value="#{transactionView.currentTransaction.totalHT}" />
                                        </p:column>
                                        <p:column>
                                            <h:outputText value="#{transactionView.currentTransaction.totalTVA}" />
                                        </p:column>
                                        <p:column>
                                            <h:outputText value="#{transactionView.currentTransaction.totalTTC}" />
                                        </p:column>
                                    </p:row>
                                </p:panelGrid>
                                <p:commandButton value="Recalculer le total" icon="pi pi-refresh"
                                    action="#{transactionView.calculateTotal}" update="invoiceTotal" />
                            </div>
                        </p:tab>
                    </p:accordionPanel>
                </p:tab>
            </p:accordionPanel>
        </div>

        <p:dialog header="Complétion automatique" id="openAiInvoiceLine" widgetVar="openAiInvoiceLine">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Texte à traiter</h3>
                </div>
                <div class="card-body">
                    <p:inputTextarea id="openAiInvoiceLineText" value="#{transactionView.textForItem}" rows="20"
                        cols="100" autoResize="false" />
                </div>
                <div class="card-footer">
                    <p:commandButton class="invoiceCardInput" value="Analyser" icon="pi pi-search"
                        actionListener="#{transactionView.openAiInvoiceLineAnalizer}"
                        oncomplete="PF('openAiInvoiceLine').hide()"
                        update="globalTab:vendorInvoice:transaction:savedTransactions:newTransaction:transactionLineTable" />
                </div>
            </div>
        </p:dialog>

        <p:contextMenu for="globalTab:vendorInvoice:transaction:savedTransactions:newTransaction:transactionLineTable"
            id="vendorInvoiceTableMenu">
            <p:menuitem value="Supprimer" icon="pi pi-trash"
                update="globalTab:vendorInvoice:transaction:savedTransactions:newTransaction:transactionLineTable"
                actionListener="#{transactionView.deleteTransactionLine}" />
        </p:contextMenu>
    </h:form>

</ui:composition>